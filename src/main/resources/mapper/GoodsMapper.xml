<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.GoodsMapper">

    <resultMap id="BaseResultMap" type="com.example.pojo.Goods">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Nov 20 19:55:35 CST 2022.
        -->
        <id column="id" jdbcType="INTEGER" property="id" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="price" jdbcType="DECIMAL" property="price" />
        <result column="uid" jdbcType="INTEGER" property="uid" />
        <result column="desc" jdbcType="LONGVARCHAR" property="desc" />
        <result column="view" jdbcType="INTEGER" property="view" />
        <result column="count" jdbcType="INTEGER" property="count" />
        <result column="cover" jdbcType="VARCHAR" property="cover" />
        <result column="g_cid" jdbcType="INTEGER" property="gCid" />
        <result column="g_sub_cid" jdbcType="INTEGER" property="gSubCid" />
        <result column="is_del" jdbcType="INTEGER" property="isDel" />
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
        <result column="create_by" jdbcType="VARCHAR" property="createBy" />
    </resultMap>

    <select id="getGoods" parameterType="java.lang.Integer" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Nov 20 19:55:35 CST 2022.
        -->
        select *
        from ss_goods
        where id = #{id,jdbcType=INTEGER}
    </select>

    <select id="queryAllGoods" resultMap="BaseResultMap">
        SELECT * FROM `ss_goods`
        <if test="cat != null">
            where g_sub_cid = #{cat} and is_del >= 0
        </if>
        <if test="cid != null">
            where `g_cid`=#{cid} and is_del >= 0
        </if>
        <if test="start != -1 and end != -1">
            LIMIT #{start},#{end}
        </if>
    </select>

    <select id="getGoodsCount" resultType="int" >
        SELECT COUNT(ss_goods.id) FROM ss_goods
    </select>

    <select id="queryGoods" resultMap="BaseResultMap">
        SELECT * FROM `ss_goods` WHERE g_sub_cid=#{gSubCid} AND is_del >= 0 ORDER BY `view` DESC LIMIT 5
    </select>

    <select id="searchGoods" resultMap="BaseResultMap">
        SELECT * FROM `ss_goods`
                 WHERE
        <if test="search != ''">
            `ss_goods`.`name` like '%' #{search} '%' AND
        </if>
            is_del >= 0
    </select>

    <select id="queryHotGoods" resultMap="BaseResultMap">
        SELECT * FROM `ss_goods` WHERE is_del >= 0 ORDER BY `view` DESC LIMIT 15
    </select>

    <select id="likeGoods" resultMap="BaseResultMap">
        SELECT * FROM `ss_goods` WHERE is_del >= 0 ORDER BY RAND() LIMIT 20;
    </select>

    <update id="changeGoodsStatus">
        UPDATE ss_goods SET is_del = #{status} WHERE id = #{id}
    </update>

    <update id="updateGoodsInfo" parameterType="com.example.pojo.Goods">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Nov 20 19:55:35 CST 2022.
        -->
        update ss_goods
        set name = #{name,jdbcType=VARCHAR},
        price = #{price,jdbcType=DECIMAL},
        uid = #{uid,jdbcType=INTEGER},
        <if test="desc != null">
            `desc` = #{desc,jdbcType=LONGVARCHAR},
        </if>
        view = #{view,jdbcType=INTEGER},
        count = #{count,jdbcType=INTEGER},
        cover = #{cover,jdbcType=VARCHAR},
        g_cid = #{gCid,jdbcType=INTEGER},
        g_sub_cid = #{gSubCid,jdbcType=INTEGER},
        <if test="count == 0">
            is_del = -1,
        </if>
        create_time = #{createTime,jdbcType=TIMESTAMP},
        create_by = #{createBy,jdbcType=VARCHAR}
        where id = #{id,jdbcType=INTEGER}
    </update>

    <insert id="insertGoods" parameterType="com.example.pojo.Goods" useGeneratedKeys="true" keyProperty="id">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Mon Nov 21 12:40:34 CST 2022.
        -->
        insert into ss_goods (`name`, `price`,
        `uid`, `desc`, `view`, `count`,
        `cover`, `g_cid`, `g_sub_cid`,
        `is_del`, `create_time`,
        `create_by`)
        values (#{name,jdbcType=VARCHAR}, #{price,jdbcType=DECIMAL},
        #{uid,jdbcType=INTEGER}, #{desc,jdbcType=VARCHAR}, #{view,jdbcType=INTEGER}, #{count,jdbcType=INTEGER},
        #{cover,jdbcType=INTEGER}, #{gCid,jdbcType=INTEGER}, #{gSubCid,jdbcType=INTEGER},
        #{isDel,jdbcType=INTEGER}, #{createTime,jdbcType=TIMESTAMP},
        #{createBy,jdbcType=VARCHAR})
    </insert>



</mapper>